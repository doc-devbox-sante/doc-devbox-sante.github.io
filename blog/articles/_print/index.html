<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="fr" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.104.2" />
<link rel="canonical" type="text/html" href="/blog/articles/">
<link rel="alternate" type="application/rss&#43;xml" href="/blog/articles/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Articles | DevBox-Santé</title>
<meta name="description" content="La Documentation">
<meta property="og:title" content="Articles" />
<meta property="og:description" content="La Documentation" />
<meta property="og:type" content="website" />
<meta property="og:url" content="/blog/articles/" /><meta property="og:site_name" content="DevBox-Santé" />

<meta itemprop="name" content="Articles">
<meta itemprop="description" content="La Documentation"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Articles"/>
<meta name="twitter:description" content="La Documentation"/>




<link rel="preload" href="/scss/main.min.9f0a2161d80a195a6248b609ca0dbf542572bf374abeeea73f4afa094e9b8cf6.css" as="style">
<link href="/scss/main.min.9f0a2161d80a195a6248b609ca0dbf542572bf374abeeea73f4afa094e9b8cf6.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/devbox-sante.css" type="text/css">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-39129192-3"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-39129192-3');
}
</script>
  </head>
  <body class="td-section td-blog">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Composant_16_14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 132.5 118.9" style="enable-background:new 0 0 132.5 118.9"><style>.st0{fill:url(#SVGID_1_)}.st1{fill:#fff}.st2{fill:url(#SVGID_2_)}.st3{fill:url(#SVGID_3_)}.st4{fill:#d34a3c}.st5{fill:none;stroke:#fff;stroke-width:6}</style><g id="Rectangle_69" transform="translate(65.996 38.892)"><linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="-44.4861" y1="64.4079" x2="-45.1313" y2="65.2243" gradientTransform="matrix(66.506 0 0 -66.507 3013.5039 4344.1382)"><stop offset="0" style="stop-color:#7613E0"/><stop offset="1" style="stop-color:#9F57ED"/></linearGradient><path class="st0" d="M23.3 3.8h19.9c10.7.0 19.4 8.7 19.4 19.4v19.9c0 10.7-8.7 19.4-19.4 19.4H23.3c-10.7.0-19.4-8.7-19.4-19.4V23.2C3.9 12.5 12.6 3.8 23.3 3.8z"/><g><path class="st1" d="M44.5 66.5H22c-12.1.0-22-9.9-22-22V22C0 9.9 9.9.0 22 0h22.5c12.1.0 22 9.9 22 22v22.5c0 12.1-9.9 22-22 22zM22 6C13.2 6 6 13.2 6 22v22.5c0 8.8 7.2 16 16 16h22.5c8.8.0 16-7.2 16-16V22c0-8.8-7.2-16-16-16H22z"/></g></g><g id="Rectangle_70" transform="translate(110.109) rotate(90)"><linearGradient id="SVGID_2_" gradientUnits="userSpaceOnUse" x1="103.5653" y1="89.1427" x2="104.2366" y2="89.9162" gradientTransform="matrix(0 -66.506 -66.507 0 5940.3726 6895.6235)"><stop offset="0" style="stop-color:#67ED9A"/><stop offset="1" style="stop-color:#4AC87A"/></linearGradient><path class="st2" d="M23 1.5h21.5c11.6.0 21 9.4 21 21V44c0 11.6-9.4 21-21 21H23C11.4 65 2 55.6 2 44V22.5c0-11.6 9.4-21 21-21z"/><g><path class="st1" d="M66.5 22v22.5c0 12.1-9.9 22-22 22H22c-12.1.0-22-9.9-22-22V22C0 9.9 9.9.0 22 0h22.5c12.1.0 22 9.9 22 22zM6 44.5c0 8.8 7.2 16 16 16h22.5c8.8.0 16-7.2 16-16V22c0-8.8-7.2-16-16-16H22C13.2 6 6 13.2 6 22V44.5z"/></g></g><g id="Rectangle_71" transform="translate(88.714 52.366) rotate(90)"><linearGradient id="SVGID_3_" gradientUnits="userSpaceOnUse" x1="50.3774" y1="67.1362" x2="49.7677" y2="66.2039" gradientTransform="matrix(0 -66.506 -66.507 0 4517.4551 3412.9705)"><stop offset="0" style="stop-color:#FFA800"/><stop offset="1" style="stop-color:#FFC24D"/></linearGradient><path class="st3" d="M22.8 2.3h21c11.3.0 20.5 9.2 20.5 20.5v21c0 11.3-9.2 20.5-20.5 20.5h-21c-11.3.0-20.5-9.2-20.5-20.5v-21C2.3 11.4 11.4 2.3 22.8 2.3z"/><g><path class="st1" d="M66.5 22v22.5c0 12.1-9.9 22-22 22H22c-12.1.0-22-9.9-22-22V22C0 9.9 9.9.0 22 0h22.5c12.1.0 22 9.9 22 22zM6 44.5c0 8.8 7.2 16 16 16h22.5c8.8.0 16-7.2 16-16V22c0-8.8-7.2-16-16-16H22C13.2 6 6 13.2 6 22V44.5z"/></g></g><g id="Rectangle_72" transform="translate(66.506 13.481) rotate(90)"><g><path class="st4" d="M23 1.5h21.5c11.6.0 21 9.4 21 21V44c0 11.6-9.4 21-21 21H23C11.4 65 2 55.6 2 44V22.5c0-11.6 9.4-21 21-21z"/></g><path class="st5" d="M22 3h22.5c10.5.0 19 8.5 19 19v22.5c0 10.5-8.5 19-19 19H22c-10.5.0-19-8.5-19-19V22C3 11.5 11.5 3 22 3z"/></g></svg></span><span class="navbar-brand__name">DevBox-Santé</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/dmp/"><i class='icon iconNav icon-dmp'></i><span>DMP</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/insi/"><i class='icon iconNav icon-ins'></i><span>INSi</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/ms-sante/"><i class='icon iconNav icon-mssante'></i><span>MSS</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/cps/"><i class='icon iconNav icon-cps-puce'></i><span>CPS</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/vitale/"><i class='icon iconNav icon-sesam-puce'></i><span>Vitale</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/apcv/"><i class='icon iconNav icon-apcv'></i><span>ApCV</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/annuaire/"><i class='icon iconNav icon-directory'></i><span>Annuaire</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/installer/"><i class='icon icon-devbox'></i><span>Installation</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="/blog/"><i class='fa fa-blog'></i><span class="active">Blog</span></a>
      </li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    
  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
Version imprimable multipages.
<a href="#" onclick="print();return false;">Cliquer ici pour imprimer</a>.
</p><p>
<a href="/blog/articles/">Retour à la version par défaut</a>.
</p>
</div>



<h1 class="title">Articles</h1>





    <ul>
    
  
  
  
  

  
    
    
	

    <li><a href="#pg-ba62f850a65f9e9403fe25026c9ef1fc">Migration TLSv1.3 dans les différents téléservices</a></li>



    
  
    
    
	

    <li><a href="#pg-9412779eb92975b245d97d136b34c343">Les identifiants nationaux expliqués</a></li>



    
  
    
    
	

    <li><a href="#pg-a39e056eb44a3a13be81a9edc262d0fe">INSi : Datamatrix dans Docker</a></li>



    
  
    
    
	

    <li><a href="#pg-b8aed82ac63ffbbc9521a73c3dcab002">DMP : Homologation 2.6.1</a></li>



    
  
    
    
	

    <li><a href="#pg-16efb94d07fcae11c5ef318ceab3a267">SEGUR : la DevBox-Santé dans le référentiel d’exigences Hopital</a></li>



    
  
    
    
	

    <li><a href="#pg-d3928a75ac050a5401dea3b2d141118f">Intégration de l’annexe CI-SIS INS dans la DevBox-santé DMP</a></li>



    
  
    
    
	

    <li><a href="#pg-7a795e7ebeb6c3143b5c2e77fa99e773">Vérification d’une signature CPS avec OpenSSL</a></li>



    
  
    
    
	

    <li><a href="#pg-26341b6d13bd255a6cc6a305c272051f">Discordance INS et pièce d&#39;identité</a></li>



    
  
    
    
	

    <li><a href="#pg-53246894ddabd5c5431dea13246f9531">DevBox-santé dans un environnement RDP/Citrix</a></li>



    
  
    
    
	

    <li><a href="#pg-cdba9978ed60e0bc94b888ba96d55b0a">Les métadonnées des documents du DMP</a></li>



    
  
    
    
	

    <li><a href="#pg-51b3c2e7bd59e073db68d278349697be">eCPS &gt; Intégration de ProSantéConnect</a></li>



    
  
    
    
	

    <li><a href="#pg-fb097e60bfd5ea8478e641381706b920">Installation d&#39;un lecteur PC/SC sous linux ubuntu</a></li>



    
  
    
    
	

    <li><a href="#pg-16ce0b61ec2098c0edd36dbc9f3228b1">Installer &gt; lancer la DevBox-Santé depuis un navigateur</a></li>



    
  
    
    
	

    <li><a href="#pg-87ab15ff12fb2fae33bbe79303f82722">DMP &gt; matrice habilitation</a></li>



    
  
    
    
	

    <li><a href="#pg-c20c69a2aad7fcab8fb238d2bf53a8f0">Diagnostiquer des problèmes d&#39;accès aux lecteurs</a></li>



    
  
    
    
	

    <li><a href="#pg-adb945f145a47b5cc09702edfd029719">Génération de la documentation de la DevBox-Santé</a></li>



    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    


  

<div class="td-content" style="">
    <h1 id="pg-ba62f850a65f9e9403fe25026c9ef1fc">Migration TLSv1.3 dans les différents téléservices</h1>
	<div class="lead">Validation du protocole TLSv1.3 dans la DevBox-Santé INSi et ApCV</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2023-08-07" class="text-muted">Monday, August 07, 2023</time>
        
	</div>
	<p>L&rsquo;accès aux différents TLSi exige désormais la version TLSv1.3, et impose des nouvelles suites cryptographiques acceptées pour le TLSv1.3 :</p>
<ul>
<li>TLS13-AES128-GCM-SHA256</li>
<li>TLS13-AES256-GCM-SHA384</li>
<li>TLS13-CHACHA20-POLY1305-SHA256</li>
</ul>
<p>La configuration de l&rsquo;environnement java de la Devbox-santé va suivre ces nouvelles prérogatives dans les futures versions des tools IGC santé 1.3.0.</p>
<p>Néanmoins, la DevBox-santé est configurée par défaut pour utiliser le protocole TLSv1.2 mais utilise une JRE (Java Runtime Environnement) supportant le TLSv1.3.</p>
<p>Des tests forçant l&rsquo;usage du protocole TLSv1.3 pour le composant INSi sur l&rsquo;environnement de qualification ont été réalisés avec succès.</p>
<p>Nous pouvons donc être confiant pour la migration TLSv1.3.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-9412779eb92975b245d97d136b34c343">Les identifiants nationaux expliqués</h1>
	<div class="lead">Une tentative d&rsquo;explication des structures des différents identifiants IdNatPs et IdNatStruct et leur interprétation dans la DevBox-Santé DMP</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2023-05-09" class="text-muted">Tuesday, May 09, 2023</time>
        
	</div>
	

<div class="pageinfo pageinfo-primary">
<p>La structure des différents Identifiants nationaux sont décrits dans le <a href="https://mos.esante.gouv.fr/">MOS</a>.</p>

</div>

<p>Le Cadre d&rsquo;Intéropérabilité des Systèmes d&rsquo;Information de Santé a dédié une documentation pour définir toutes les méta données des structures et personnel de santé : <a href="https://esante.gouv.fr/annexe-sources-des-donnees-personnes-et-structures">https://esante.gouv.fr/annexe-sources-des-donnees-personnes-et-structures</a></p>
<p>Concernant l&rsquo;IdNat_PS et l&rsquo;IdNat_Struct, cette documentation fait dorénavant référence au MOS :</p>
<ul>
<li>IdNat_Struct : <a href="https://mos.esante.gouv.fr/4.html#_88711c28-b4b0-41d6-abd5-bf4e3e9b2e6d">https://mos.esante.gouv.fr/4.html#_88711c28-b4b0-41d6-abd5-bf4e3e9b2e6d</a></li>
<li>IdNat_PS : <a href="https://mos.esante.gouv.fr/2.html#_b1a86104-5f11-47d6-bd74-cab5b25a6e16">https://mos.esante.gouv.fr/2.html#_b1a86104-5f11-47d6-bd74-cab5b25a6e16</a></li>
</ul>
<h3 id="idnat_struct">IdNat_Struct</h3>
<p>Dont voici l&rsquo;impression écran à la rédaction de cet article :</p>
<p><img src="IdNat_Struct_printscreen.png" alt="Mos id nat struct"></p>
<h3 id="idnat_ps">IdNat_PS</h3>
<p>Dont voici l&rsquo;impression écran à la rédaction de cet article :</p>
<p><img src="IdNat_PS_printscreen.png" alt="Mos id nat PS"></p>
<h3 id="dans-la-devbox-santé">Dans la DevBox-santé</h3>
<blockquote>
<p>Dans la DevBox-santé DMP, l&rsquo;identifiantNational de <strong>structure</strong> doit contenir le type de son identifiant en <strong>préfixe</strong>.</p>
<p>À contrario, l&rsquo;identifiant national du <strong>PS</strong> étant déjà typé par le nom de l&rsquo;identifiant (<code>rpps</code>, <code>adeli</code>), il n&rsquo;est donc pas obligatoirement préfixé.</p>
</blockquote>
<p>Ce qui donne pour ces identifiants le mapping suivant dans la DevBox-santé DMP dans le cas d&rsquo;un internal Id du professionnel d&rsquo;une structure :</p>
<p><img src="idnat_screen.png" alt="Génération des Id dans CDA"></p>
<p>Ou plus simplement l&rsquo;usage du RPPS obtenu par la lecture de la carte CPS en authontification directe (en authentification indirecte, disponible depuis la DevBox-santé DMP 5.0.8) :</p>
<p><img src="rpps_screen.png" alt="rpps_screen"></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-a39e056eb44a3a13be81a9edc262d0fe">INSi : Datamatrix dans Docker</h1>
	<div class="lead">Une image permettant la génération des INS_DATAMATRIX</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2023-03-01" class="text-muted">Wednesday, March 01, 2023</time>
        
	</div>
	<p>Les datamatrix générées par nos outils, ne permettent pas d&rsquo;accéder à l&rsquo;environnement graphique et génère une erreur de chargement de FONT.
En effet, un appel au <code>ins datamatrix controller</code> :</p>
<pre tabindex="0"><code class="language-curl" data-lang="curl">curl -X POST &#34;http://localhost:8080/insi/v2/datamatrix/jpg?sizeInPx=128&#34; -H &#34;accept: */*&#34; -H &#34;Content-Type: application/json&#34; \
-d &#34;{ \&#34;matriculeINS\&#34;: { \&#34;valeur\&#34;: \&#34;1010663220754\&#34;, \&#34;cle\&#34;: \&#34;60\&#34;, \&#34;identifiantSysteme\&#34;: \&#34;1.2.250.1.213.1.4.8\&#34; }, \&#34;traitsIdentite\&#34;: { \&#34;nomFamille\&#34;: \&#34;D&#39;ARTAGNAN DE L&#39;HERAULT\&#34;, \&#34;prenomActeNaissance\&#34;: \&#34;PIERRE-ALAIN GUNTHER\&#34;, \&#34;sexeAdministratif\&#34;: \&#34;M\&#34;, \&#34;dateNaissance\&#34;: \&#34;2001-06-17\&#34;, \&#34;lieuNaissance\&#34;: \&#34;63220\&#34; }}&#34;
</code></pre><p>Peut générer l&rsquo;erreur décrite dans le stackoverflow : <a href="https://stackoverflow.com/questions/69814102/spring-boot-in-docker-build-by-buildpack-cannot-load-font">https://stackoverflow.com/questions/69814102/spring-boot-in-docker-build-by-buildpack-cannot-load-font</a></p>
<p>Donc pour que les Datamatrix puissent être générés correctement dans ce cas d&rsquo;erreur dans Docker, vous pouvez générer une nouvelle image en installant la <code>fontconfig</code> nécessaire.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Dockerfile" data-lang="Dockerfile"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">FROM</span><span style="color:#4e9a06"> devboxsante/devbox:version</span><span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000"></span><span style="color:#204a87;font-weight:bold">USER</span><span style="color:#4e9a06"> root </span><span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000"></span><span style="color:#204a87;font-weight:bold">RUN</span> apt-get update <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>    apt-get install --assume-yes fontconfig <span style="color:#ce5c00;font-weight:bold">&amp;&amp;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>    rm -rf /var/lib/apt/lists/* /var/cache/debconf/*<span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000"></span><span style="color:#204a87;font-weight:bold">EXPOSE</span><span style="color:#4e9a06"> 8080</span><span style="color:#a40000">
</span></span></span></code></pre></div><p>Nous allons trouver un moyen d&rsquo;incorporer cette config dans notre image et régler cette issue <a href="https://devbox-sante.atlassian.net/browse/INSI-64">https://devbox-sante.atlassian.net/browse/INSI-64</a> .</p>
<p>Stay tuned&hellip;</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-b8aed82ac63ffbbc9521a73c3dcab002">DMP : Homologation 2.6.1</h1>
	<div class="lead">Fier d&rsquo;avoir coché toutes les cases</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2022-11-30" class="text-muted">Wednesday, November 30, 2022</time>
        
	</div>
	<p>Lors de notre dernier passage d’homologation, nous avons été fiers de cocher toutes les cases.</p>
<p><img src="PDV_toutes_les_cases.png" alt="Homologation_PDV_toutes_les_cases"></p>
<p>Mais ce n’est pas fini, nous apportons désormais une API permettant de générer facilement :</p>
<ul>
<li>Les volets de <a href="/dmp/cda/crBiologie">CR-BIO</a></li>
<li>Les volets de <a href="/dmp/cda/vaccination">Note de vaccination</a></li>
</ul>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-16efb94d07fcae11c5ef318ceab3a267">SEGUR : la DevBox-Santé dans le référentiel d’exigences Hopital</h1>
	<div class="lead">Exemple de la prise en charge de XDM et CDA dans un DPI du couloir Hôpital</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2022-06-09" class="text-muted">Thursday, June 09, 2022</time>
        
	</div>
	<h2 id="outils-xdm">Outils XDM</h2>
<h3 id="scenario-hop-11">Scenario HOP-11</h3>
<p>Dans le <a href="https://esante.gouv.fr/sites/default/files/media_entity/documents/REM-HOP-DPI-Va1.xlsx">Référentiel d&rsquo;exigences – Hôpital – DPI – Annexe 1 – Vague 1 (xlsx)</a>, on peut lire l’exigence HOP-11.</p>
<blockquote>
<p>Le système DOIT proposer une interface pour intégrer, a minima de façon manuelle, voire de façon automatique, les documents en CDAR2 N1 reçus via MSSanté au format IHE_XDM.zip.</p>
</blockquote>
<p>Cette exigence demande de pouvoir récupérer un fichier attaché au format XDM.zip d’un document reçu de la Messagerie Sécurisé de Santé. Récupérer ce fichier et l’interpréter via la DevBox-Santé rien de plus simple, il suffit de réaliser un POST HTTP à la boite à outils XDM :</p>
<p><img src="XDM_TO_DMP_SwaggerUI.png" alt="XDM_TO_DMP_SwaggerUI.png"></p>
<p>ou autrement dit en curl :</p>
<pre tabindex="0"><code class="language-curl" data-lang="curl">curl -X POST &#34;http://localhost:8080/xdm/to/dmp&#34; -H &#34;accept: application/json&#34; -H &#34;Content-Type: multipart/form-data&#34; -F &#34;file=@xdm.zip;type=application/x-zip-compressed&#34;
</code></pre><p>La DevBox-santé va lire l’archive ZIP, l’interpréter, et vous obtenez la réponse json suivante :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;comments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;submissionComments&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;contentType&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;04&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;documents&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;classCode&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;10&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;comments&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;document comments&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;confidentialities&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;N&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;content&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;ZG9jdW1lbnQgY29udGVudA==&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;creationTime&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20220608162831&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;entryUuid&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;76875ea0-e741-41ae-93e6-a5026bb0b0f8&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;events&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;code&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;H33&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;codingScheme&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2.16.840.1.113883.6.3&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;displayName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DÃ©collement et dÃ©chirement de la rÃ©tine&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;format&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;urn:ihe:iti:xds-sd:text:2008&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;legalAuthenticator&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;internalId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;3750100125/123&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;nom&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;auteurNom&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;prenom&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;auteurPrenom&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;specialite&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;G15_10/SM30&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;structureSante&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;idNational&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1750100125&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;nom&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;structureNom&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;patient&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;ins&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;279035121518989&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;insAutorite&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.2.250.1.213.1.4.10&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;nomUsuel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;PAT-TROIS&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;prenomUsuel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Dominique&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;dateDeNaissance&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;19530724&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;ordreDeNaissance&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;sexe&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;M&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;practiceSetting&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;AMBULATOIRE&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;serviceStartTime&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20111025&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;serviceStopTime&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;20111125&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;title&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;document titre&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;type&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;11488-4&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;uniqueId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.2.250.1.287.1.1234567.1.16547057180821&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;repositoryUniqueId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.2.250.1.287.1.1234567&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;confidentialitiesAsListOfEnum&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;N&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;patient&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;ins&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;279035121518989&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;insAutorite&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.2.250.1.213.1.4.10&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;ordreDeNaissance&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;title&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;submissionTitle&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;uuid&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;83bd0ae8-ccfb-4313-bd6b-4ee77f73a0f8&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;uniqueId&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;1.2.250.1.287.1.1234567.3.16547057180852&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Si vous avez déjà intégré la DevBox-Santé DMP vous remarquerez que c’est exactement la même structure de données que pour une soumission de documents vers le DMP. Le contenu binaire du document et dans la balise <code>content</code> encodé en Base64.</p>
<p>Vous voulez réaliser l’opération inverse, générer une archive XDM.zip à partir d’une soumission :</p>
<p><img src="DMP_TO_XDM_SwaggerUI.png" alt="DMP_TO_XDM_SwaggerUI.png"></p>
<h2 id="outils-cda">Outils CDA </h2>
<p>Comme pour l’archive XDM, il est possible de lire/écrire les documents CDA R2 N1 à structuration minimale et récupérer un <code>DMPCDocument</code> de la DevBox-santé DMP.</p>
<h3 id="exigence-doc2">Exigence DOC2 </h3>
<p>En effet, l’exigence DOC 2 nous dit :</p>
<blockquote>
<p>Le système DOIT produire TYPE_DE_DOCUMENT au format CDA R2 N1 avec un PDF encapsulé en base 64 conformément au volet Structuration Minimale du CI-SIS [CISIS1].</p>
</blockquote>
<p>Pour cela :</p>
<p><img src="DMP_TO_CDA_SwaggerUI.png" alt="DMP_TO_CDA_SwaggerUI.png"></p>
<h2 id="outils-pdf-et-datamatrix-ins">Outils PDF et Datamatrix INS</h2>
<h3 id="exigenc-doc4">Exigenc DOC4</h3>
<p>Mais encore, que répondre à l’exigence DOC4 :</p>
<blockquote>
<p>Le système DOIT produire les documents &ldquo;Lettre de liaison en sortie&rdquo; et &ldquo;Compte rendu opératoire&rdquo;  avec l&rsquo;apposition du datamatrix INS dans le PDF/A-1 conformément au référentiel datamatrix de l&rsquo;INS [INS5].</p>
</blockquote>
<p>Pour cela, la DevBox-Santé peut vous aider également pour la génération des PDF/A :</p>
<p><img src="PDF-A_tooling_swagger.png" alt="PDF-A_tooling_swagger.png"></p>
<p>Mais aussi pour les datamatrix INS : <a href="/insi/howtos/datamatrix/">/insi/howtos/datamatrix/</a></p>
<h2 id="outils-annuaire">Outils Annuaire</h2>
<p>L’annuaire de la devbox-santé peut également répondre aux exigences concernant l’annuaire, comme par exemple <strong>ANN1</strong> :</p>
<blockquote>
<p>Le système DOIT être en capacité d’intégrer automatiquement l’extraction publique « PS_LibreAcces_Personne_activite »  de l’annuaire santé.fr, conformément au Dossier des Spécifications Fonctionnelles et Techniques Fichiers d&rsquo;extraction des données en libre accès [ANN1].</p>
</blockquote>
<p>Une présentation de l’annuaire est disponible <a href="/annuaire">ici</a>.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-d3928a75ac050a5401dea3b2d141118f">Intégration de l’annexe CI-SIS INS dans la DevBox-santé DMP</h1>
	<div class="lead">La prise en charge de l’identifiant national de santé (INS) dans les standards d’interopérabilité et les volets du CI-SIS dans la DevBox-Santé DMP</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2022-05-20" class="text-muted">Friday, May 20, 2022</time>
        
	</div>
	<p>La prise en charge de l’identifiant national de santé (INS) dans les standards d’interopérabilité et les volets du CI-SIS défini dans
<a href="https://esante.gouv.fr/sites/default/files/media_entity/documents/ans_cisis-tec_annexe-ins_1.3.pdf">l’annexe CISIS de l’ANS</a> a impliqué quelques changements dans la DevBox-Santé DMP (<a href="/dmp/versions">version 4.7.7</a>).</p>
<p>Voici l’interprétation que nous avons faîtes de la gestion des noms et prénoms de l’annexe INS vers la génération CDA et XDS :</p>
<p>Supposons les informations du patient suivantes :</p>
<ul>
<li><strong>Nom de Famille</strong> : <code>nomNaissance</code>    (origine TS INSi)</li>
<li><strong>Prénoms de l’acte de naissance</strong> :  <code>Prenom1 Prenom2</code> (origine TS INSi)</li>
<li><strong>Premier Prénom de l’acte de naissance</strong> : <code>Prenom1</code> (origine TS INSi)</li>
<li><strong>Nom Utilisé</strong> : <code>nomUtilise</code>    (origine CarteVitale / LPS)</li>
<li><strong>Prénom Utilisé</strong> : <code>PrenomUtilise</code> (origine Carte Vitale / LPS)</li>
</ul>
<p>Alors, le clinical document CDA contiendra : </p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;patient&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;given&gt;</span>Prenom1 Prenom2<span style="color:#204a87;font-weight:bold">&lt;/given&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;family</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;BR&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>nomNaissance<span style="color:#204a87;font-weight:bold">&lt;/family&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;family</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;CL&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>nomUtilise<span style="color:#204a87;font-weight:bold">&lt;/family&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;given</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;BR&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>Prenom1<span style="color:#204a87;font-weight:bold">&lt;/given&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;given</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;CL&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>PrenomUtilise<span style="color:#204a87;font-weight:bold">&lt;/given&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/patient&gt;</span>
</span></span></code></pre></div><p>la soumission XDS contiendra:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;Slot</span> <span style="color:#c4a000">name=</span><span style="color:#4e9a06">&#34;sourcePatientInfo&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;ValueList&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;Value&gt;</span>PID-5|nomNaissance^Prenom1^Prenom1 Prenom2^^^^L<span style="color:#204a87;font-weight:bold">&lt;/Value&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;Value&gt;</span>PID-5|nomUtilise^PrenomUtilise^^^^^D<span style="color:#204a87;font-weight:bold">&lt;/Value&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;/ValueList&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/Slot&gt;</span>
</span></span></code></pre></div><p>Dans la DevBox-santé DMP en Java, il faudra le coder de la manière suivante :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">DMPCPatient</span> <span style="color:#000">patient</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setNomPatronymique</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;nomNaissance&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setNomUsuel</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;nomUtilise&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setPrenom</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;Prenom1 Prenom2&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">prenomUsuel</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;PrenomUtilise&#34;</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><p>En Json :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;patient&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;nomPatronymique&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;nomNaissance&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;nomUsuel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;nomUtilise&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;prenom&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Prenom1 Prenom2&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;prenomUsuel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;PrenomUtilise&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Dans le cas de RUTH, de la carte vitale de test 01 INSi:</p>
<ul>
<li><strong>Nom de Famille</strong> : <code>NESSI</code>    (origine TS INSi)</li>
<li><strong>Prénoms de l’acte de naissance</strong> :  <code>RUTH ISABELLE</code> (origine TS INSi)</li>
<li><strong>Premier Prénom de l’acte de naissance</strong> : <code>RUTH</code> (origine TS INSi)</li>
<li><strong>Nom Utilisé</strong> : <code>DE VINCI</code>    (origine CarteVitale / LPS)</li>
<li><strong>Prénom Utilisé</strong> : <code>RUTH</code> (origine Carte Vitale / LPS)</li>
</ul>
<p>Le CDA : </p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;patient&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;given&gt;</span>RUTH ISABELLE<span style="color:#204a87;font-weight:bold">&lt;/given&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;family</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;BR&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>NESSI<span style="color:#204a87;font-weight:bold">&lt;/family&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;family</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;CL&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>DE VINCI<span style="color:#204a87;font-weight:bold">&lt;/family&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;given</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;BR&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>RUTH<span style="color:#204a87;font-weight:bold">&lt;/given&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;given</span> <span style="color:#c4a000">qualifier=</span><span style="color:#4e9a06">&#34;CL&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>RUTH<span style="color:#204a87;font-weight:bold">&lt;/given&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/patient&gt;</span>
</span></span></code></pre></div><p>La soumission XDS :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;Slot</span> <span style="color:#c4a000">name=</span><span style="color:#4e9a06">&#34;sourcePatientInfo&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;ValueList&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;Value&gt;</span>PID-5|NESSI^RUTH^RUTH ISABELLE^^^^L<span style="color:#204a87;font-weight:bold">&lt;/Value&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;Value&gt;</span>PID-5|DE VINCI^RUTH^^^^^D<span style="color:#204a87;font-weight:bold">&lt;/Value&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;/ValueList&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;/Slot&gt;</span>
</span></span></code></pre></div><p>Dans la DevBox-santé DMP en Java :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">DMPCPatient</span> <span style="color:#000">patient</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#ce5c00;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setNomPatronymique</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;NESSI&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setNomUsuel</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;DE VINCI&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">setPrenom</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;RUTH ISABELLE&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">patient</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">prenomUsuel</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;RUTH&#34;</span><span style="color:#ce5c00;font-weight:bold">);</span>
</span></span></code></pre></div><p>en Json :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#4e9a06">&#34;patient&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;nomPatronymique&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;NESSI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;nomUsuel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;DE VINCI&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;prenom&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;RUTH ISABELLE&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;prenomUsuel&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;RUTH&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-7a795e7ebeb6c3143b5c2e77fa99e773">Vérification d’une signature CPS avec OpenSSL</h1>
	<div class="lead">Comment vérifier une signature réalisée depuis Devbox-santé CPS avec OpenSSL</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2022-04-07" class="text-muted">Thursday, April 07, 2022</time>
        
	</div>
	<p>La CPSFacade et son proxy REST Devbox-Santé-CPS expose un endpoint permettant de signer tout document. <strong>Mais une fois signé le contenu, comment en vérifier sa signature ?</strong></p>
<h3 id="signature-avec-devbox-santé-cps">Signature avec DevBox-Santé CPS</h3>
<p>Supposons le texte à signer suivant stocker dans le fichier <code>message.json</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span><span style="color:#204a87;font-weight:bold">&#34;message&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;hello DevBox-Santé&#34;</span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>Pour le signer vous allez utiliser le proxy cps de la DevBox-santé sur le port 9999, en CURL ça donne : </p>
<pre tabindex="0"><code class="language-curl" data-lang="curl">curl -X POST &#34;http://localhost:9999/cps/sign/for/SIGNATURE/with/SHA256WithRSA&#34; -H  &#34;accept: */*&#34; -H  &#34;Content-Type: application/json&#34; --data @message.json --output signature.txt
</code></pre><p>C’est tout ce qu’il vous faut pour obtenir une signature et le fichier <code>signature.txt</code> contiendra la signature du <code>message.json</code>.</p>
<h3 id="vérification-avec-openssl">Vérification avec OpenSSL</h3>
<p>Pour cela vous devez obtenir le certificat publique de la carte CPS :</p>
<pre tabindex="0"><code>curl -X GET &#34;http://localhost:9999/cps/certificate/SIGNATURE&#34; -H &#34;accept: */*&#34;  --output certificat.cer
</code></pre><p>Le ficher <code>certificat.cer</code> contenant le certificat ressemble à cela :</p>
<pre tabindex="0"><code>MIIIkjCCBnqgAwIBAgIQY9r/ ... S80hoFHQ=
</code></pre><p>Pour qu’il plaise à OpenSSL, il faut lui dire ce que c’est en rajoutant les lignes dans le fichier :</p>
<pre tabindex="0"><code>-----BEGIN CERTIFICATE-----
MIIIkjCCBnqgAwIBAgIQY9r/ ... S80hoFHQ=
-----END CERTIFICATE-----
</code></pre><p>Dans le certificat nous pouvons extraire la clé publique : </p>
<pre tabindex="0"><code>openssl x509 -in certificat.cer  -pubkey -noout &gt; pubkey.pem
</code></pre><p>et on obtient un fichier <code>pubkey.pem</code> :</p>
<pre tabindex="0"><code>-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsjipTM5ec9lNhfI280/S
YdDIHE0DNPS+ofB24EN4QX669BkAdefzZtAwEPfR29V+zLwRj0tgjGADXVAp/1rT
F30YPumCLwO2YYXgtx3tkQTQxadb02MIJ447VJPBPr5pqsTc4dcCnLcn/QAgVvdk
bIU2vRwa7Xkve/npoHhMnSboCCfuHcoP1WNagIZuy7v8EcNiqAXf88bt9qLjMXSE
Ff7lV5OhroRlSdQ06BHJokXWtEjbrV+TLDT0HuA0XaAfGlHFL2vJnifrhZXklTmr
ZSUceRSCleTxR0PR8pITpa7yTXz84dB33q0XrCti12YLG7oruJZ064YEzDCr+SJ7
iQIDAQAB
-----END PUBLIC KEY-----
</code></pre><p>Donc maintenant nous avons le texte, une signature, et une clé publique, il ne reste plus qu’à vérifier que la signature soit conforme :</p>
<pre tabindex="0"><code>$ openssl dgst -sha256 -verify pubkey.pem -signature signature.txt message.json
Verified OK
</code></pre><p>Et voilà.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-26341b6d13bd255a6cc6a305c272051f">Discordance INS et pièce d&#39;identité</h1>
	<div class="lead">Conduite à tenir devant une discordance entre l&rsquo;INS et l&rsquo;identité présente sur une pièce d&rsquo;identité</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2022-01-17" class="text-muted">Monday, January 17, 2022</time>
        
	</div>
	<p>Le <strong>GRIVES (Groupe Régional d&rsquo;identitovigilance en santé)</strong> a sorti une fiche pratique en décembre 2021, pour expliquer comment <strong>gérer les discordances d&rsquo;informations entre l&rsquo;INS et l&rsquo;identité présente sur une pièce d&rsquo;identité</strong>.
Elle informe sur l&rsquo;origine des différentes discordances, leurs fréquences et donne la conduite à tenir en cas de discordance.</p>
<p>Comme par exemple, les discordances sur les dates de naissance : </p>
<p><img src="FP-04-CAT-Discordances-INS-et-identite%CC%81-pie%CC%80ce-identite%CC%81-V1.4_discordance_date_naissance.png" alt="FP-04-CAT-Discordances-INS-et-identité-pièce-identité-V1.4_discordance_date_naissance.png"></p>
<p>Ou encore l&rsquo;arbre décisionnel suivant :</p>
<p><img src="FP-04-CAT-Discordances-INS-et-identite%CC%81-pie%CC%80ce-identite%CC%81-V1.4_arbre_decisionnel.png" alt="FP-04-CAT-Discordances-INS-et-identité-pièce-identité-V1.4_arbre_decisionnel.png"></p>
<p>Bien sur, ceci n&rsquo;est qu&rsquo;un petit exemple des informations que l&rsquo;on peut trouver dans ce document.</p>
<p>Elle est disponible dans la FAQ du téléservice INSI dans l&rsquo;espace industriels sesam-vitale : <a href="https://industriels.sesam-vitale.fr/group/teleservice-insi/faq-integration-insi">https://industriels.sesam-vitale.fr/group/teleservice-insi/faq-integration-insi</a></p>
<p>Elle est aussi consultable directement ici : <a href="https://grives.sante-paca.fr/wp-content/uploads/2021/12/FP-04-CAT-Discordances-INS-et-identite%CC%81-pie%CC%80ce-identite%CC%81-V1.4.pdf">https://grives.sante-paca.fr/wp-content/uploads/2021/12/FP-04-CAT-Discordances-INS-et-identite%CC%81-pie%CC%80ce-identite%CC%81-V1.4.pdf</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-53246894ddabd5c5431dea13246f9531">DevBox-santé dans un environnement RDP/Citrix</h1>
	<div class="lead">Démarrer la DevBox-Santé dans un environnement RDP / Citrix</div>
	<div class="td-byline mb-4">
		
        
		<time datetime="2021-09-20" class="text-muted">Monday, September 20, 2021</time>
        
	</div>
	<p>Lors d&rsquo;une session RDP / Citrix, il est possible qu&rsquo;un executable installé puisse accéder aux différents ports USB d&rsquo;un poste client. Pour celà, il faut réaliser un mapping des ports USB (<a href="https://superuser.com/questions/49285/access-local-usb-devices-from-a-remote-pc-via-remote-desktop">https://superuser.com/questions/49285/access-local-usb-devices-from-a-remote-pc-via-remote-desktop</a>, par exemple)</p>
<p>La DevBox-santé lancée dans un environnement Citrix/Windows RDP est accessible sur un numéro de port TCP commun à l&rsquo;ensemble des sessions utilisateurs de ce serveur RDP.</p>
<p>Dans un environnement Citrix/RDP, il est donc important qu&rsquo;une et une seule DevBox-santé soit lancée par poste utilisateur sur un numéro de port TCP différent, afin de faire le lien entre les lecteur branchés sur les ports USB du poste client et le port TCP utilisé :</p>
<pre tabindex="0"><code class="language-plantuml" data-lang="plantuml">!include https://bitbucket.org/devbox-sante/plantuml/raw/current/themes/theme-devbox-sante.puml

node &#34;Serveur RDP&#34; {
 package &#34;Session Utilisateur 1&#34; {
  [DevBox-Santé1:9999] as devbox1 DEVBOX_COLOR
 }
 package &#34;Session Utilisateur 2&#34; {
  [DevBox-Santé2:9998] as devbox2 DEVBOX_COLOR
 }
}

node &#34;Poste utilisateur 1&#34; {
   
   [Lecteur USB / Utilisateur 1] as usb1
}
node &#34;Poste utilisateur 2&#34; {
   [Lecteur USB / Utilisateur 2] as usb2
}

devbox1 -- usb1 : mapping port USB
devbox2 -- usb2 : mapping port USB
</code></pre><p>Dans cet exemple, nous avons deux utilisateurs sur deux postes différents qui ouvrent une session RDP sur un même serveur. Sur chacun de ces postes est installé un lecteur de carte.</p>
<p>Pour garantir, que l&rsquo;utilisateur 1 puisse accéder à sa DevBox-santé, il faut réaliser un mapping entre la session de l&rsquo;<strong>utilisateur 1</strong> et le numéro de port <strong>9999</strong>. Idem pour l&rsquo;<strong>utilisateur 2</strong> et le numéro de port <strong>9998</strong>.</p>
<blockquote>
<p><strong>ATTENTION : il n&rsquo;est pas possible de lancer la DevBox-santé en tant que service sur le serveur RDP car il ne pourra pas accéder au port USB du client lors de son lancement.</strong></p>
</blockquote>
<h3 id="démarrage-à-partir-dune-url-de-la-devbox-santé">Démarrage à partir d&rsquo;une url de la DevBox-santé</h3>
<p>Il est possible de démarrer la DevBox-santé pour un utilisateur donné via une URL :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>devboxsante://config?server.port<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">10000</span>
</span></span></code></pre></div>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-cdba9978ed60e0bc94b888ba96d55b0a">Les métadonnées des documents du DMP</h1>
	<div class="lead">La gestion des différentes métadonnées dans la DevBoxSanté DMP.</div>
	<div class="td-byline mb-4">
		
        
		<time datetime="2021-06-10" class="text-muted">Thursday, June 10, 2021</time>
        
	</div>
	<p>Pour comprendre comment les métadonnées des documents du DMP doivent être gérés, trois documents du Cadre d&rsquo;intéropérabilité des Systèmes d&rsquo;Information de Santé sont à étudier.</p>
<ul>
<li>le [CI_PARTAGE] dont la version courante est <a href="https://esante.gouv.fr/sites/default/files/media_entity/documents/ci-sis_service_volet-partage-documents-sante_v1.6.pdf">1.6</a> : décrit la manière d&rsquo;intégrer le stantard <a href="https://www.ihe.net/resources/technical_frameworks/#IT">XDS et XDM</a> de l&rsquo;IHE pour les données de santé en France</li>
<li>le [CI_STRU_ENTETE] dont la version courante est la <a href="https://esante.gouv.fr/sites/default/files/media_entity/documents/ci-sis_service_volet-partage-documents-sante_v1.6.pdf">1.6</a> : décrit la manière d&rsquo;intégrer le standard <a href="https://www.hl7.org/implement/standards/product_brief.cfm?product_id=7">CDAr2</a> de HL7 international</li>
<li>le [CI_ANX_CDA] dont la version courante est la <a href="https://esante.gouv.fr/sites/default/files/media_entity/documents/CI-SIS_ANX_LIENS-CDA-METADONNEES-XDS_V1.4.pdf">1.4</a> : décrit les liens entre les métadonnées des deux standards.</li>
</ul>
<h2 id="etude-de-cas">Etude de cas</h2>
<h3 id="event--lacte-médical-à-lorigine-de-la-soumission-dun-document">Event : l&rsquo;acte médical à l&rsquo;origine de la soumission d&rsquo;un document</h3>
<p>Les documents dans la DevBox-santé DMP sont représentés par un objet <code>DMPCDocument</code>. Dans ce DMPCDocument, nous allons nous intéresser à la propriété correspondant à l&rsquo;acte médical à l&rsquo;origine de la soumission dans le DMP : <strong><code>events</code></strong>.</p>
<p>La propriété <strong><code>events</code></strong> est un <code>DMPCCode</code> dont la nomenclature n&rsquo;est pas fourni par les jeux de valeurs du DMP. Mais, en lisant le [CI_ANX_CDA], on apprend que les nomenclatures autorisées pour cette métadonnée sont :</p>
<ul>
<li>La CCAM pour les actes médicaux ou médico-techniques</li>
<li>La CIM10 pour les diagnostiques</li>
<li>La LOINC pour la biologie</li>
</ul>
<blockquote>
<p>Note : la CCAM et la CIM10 (et bientôt la LOINC) sont des nomenclatures également indéxées dans notre offre <a href="https://annuaire-demo.devbox-sante.fr/nomenclature">DevBox-santé annuaire</a></p>
</blockquote>
<p><img src="20210610_rechercheCIM10.png" alt="20210610_rechercheCIM10.png"></p>
<p>Dans ce même document [CI_ANX_CDA], on peut lire également et surtout qu&rsquo;il y a une correspondance entre le <strong><code>ClinicalDocument/documentationOf/serviceEvent/code</code></strong> et le <strong><code>XDSDocumentEntry.eventCodes</code></strong>.</p>
<p>Donc si nous codons avec l&rsquo;API Java les lignes suivantes :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000">DMPCDocument</span> <span style="color:#000">document</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DMPCDocument</span><span style="color:#ce5c00;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">document</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">addEvent</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">new</span> <span style="color:#000">DMPCCode</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#4e9a06">&#34;H33&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;2.16.840.1.113883.6.3&#34;</span><span style="color:#ce5c00;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;Décollement et déchirement de la rétine&#34;</span><span style="color:#ce5c00;font-weight:bold">));</span>
</span></span></code></pre></div><p>ou encore si nous avons dans notre requete REST <code>/td21SubmitDocuments</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;request&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;submission&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&#34;documents&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>               <span style="color:#4e9a06">&#34;events&#34;</span><span style="color:#a40000">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#204a87;font-weight:bold">&#34;code&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;H33&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#204a87;font-weight:bold">&#34;codingScheme&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;2.16.840.1.113883.6.3&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>                           <span style="color:#204a87;font-weight:bold">&#34;displayName&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Décollement et déchirement de la rétine&#34;</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a40000">...</span>
</span></span><span style="display:flex;"><span><span style="color:#a40000">}</span>
</span></span></code></pre></div><p>La DevBox-Santé DMP, va générer la transaction XDS contenu dans la requête SOAP à destination du DMP. Cette dernière contiendra : </p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;ExtrinsicObject</span> <span style="color:#c4a000">id=</span><span style="color:#4e9a06">&#34;urn:uuid:8aaa0dc6-9d9e-43d0-88d1-a58833cd6b7d&#34;</span> <span style="color:#c4a000">mimeType=</span><span style="color:#4e9a06">&#34;text/xml&#34;</span> <span style="color:#c4a000">objectType=</span><span style="color:#4e9a06">&#34;urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#204a87;font-weight:bold">&lt;Classification</span> <span style="color:#c4a000">classificationScheme=</span><span style="color:#4e9a06">&#34;urn:uuid:2c6b8cb7-8b2a-4051-b291-b1ae6a575ef4&#34;</span> <span style="color:#c4a000">classifiedObject=</span><span style="color:#4e9a06">&#34;urn:uuid:8aaa0dc6-9d9e-43d0-88d1-a58833cd6b7d&#34;</span> <span style="color:#c4a000">nodeRepresentation=</span><span style="color:#4e9a06">&#34;H33&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#204a87;font-weight:bold">&lt;Slot</span> <span style="color:#c4a000">name=</span><span style="color:#4e9a06">&#34;codingScheme&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;ValueList&gt;</span>
</span></span><span style="display:flex;"><span>               <span style="color:#204a87;font-weight:bold">&lt;Value&gt;</span>2.16.840.1.113883.6.3<span style="color:#204a87;font-weight:bold">&lt;/Value&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;/ValueList&gt;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#204a87;font-weight:bold">&lt;/Slot&gt;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#204a87;font-weight:bold">&lt;Name&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;LocalizedString</span> <span style="color:#c4a000">charset=</span><span style="color:#4e9a06">&#34;UTF-8&#34;</span> <span style="color:#c4a000">value=</span><span style="color:#4e9a06">&#34;&#34;</span><span style="color:#a40000">Décollement</span> <span style="color:#a40000">et</span> <span style="color:#a40000">déchirement</span> <span style="color:#a40000">de</span> <span style="color:#a40000">la</span> <span style="color:#a40000">rétine&#34;</span> <span style="color:#c4a000">xml:lang=</span><span style="color:#4e9a06">&#34;FR&#34;</span><span style="color:#204a87;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#204a87;font-weight:bold">&lt;/Name&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#204a87;font-weight:bold">&lt;/Classification&gt;</span>
</span></span></code></pre></div><p>Le document CDA généré contiendra :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">&lt;ClinicalDocument</span> <span style="color:#c4a000">xmlns=</span><span style="color:#4e9a06">&#34;urn:hl7-org:v3&#34;</span> <span style="color:#c4a000">xmlns:xsi=</span><span style="color:#4e9a06">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span> <span style="color:#c4a000">xsi:schemaLocation=</span><span style="color:#4e9a06">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span><span style="color:#204a87;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&lt;documentationOf&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&lt;serviceEvent&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">&lt;code</span> <span style="color:#c4a000">code=</span><span style="color:#4e9a06">&#34;H33&#34;</span> <span style="color:#c4a000">codeSystem=</span><span style="color:#4e9a06">&#34;2.16.840.1.113883.6.3&#34;</span> <span style="color:#c4a000">displayName=</span><span style="color:#4e9a06">&#34;Décollement et déchirement de la rétine&#34;</span><span style="color:#204a87;font-weight:bold">/&gt;</span>
</span></span></code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>La DevBox-santé DMP en plus de gérer les différents standards techniques (SOAP, MTOM, SAML, PKCS11, PKCS12, TLS &hellip;) et fonctionnels (CPx, CI-SIS, IHE, CDA) elle prend soin d&rsquo;assurer la cohérance entre les données renseignées.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-51b3c2e7bd59e073db68d278349697be">eCPS &gt; Intégration de ProSantéConnect</h1>
	<div class="lead">Comment intégrer une application spring-boot à <a href="https://integrateurs-cps.asipsante.fr/pages/prosanteconnect/presentation-generale">ProSantéConnect</a></div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2021-06-01" class="text-muted">Tuesday, June 01, 2021</time>
        
	</div>
	<p>Lors de nos différentes intégrations, nous avons eu besoin de nous interfacer avec <a href="https://integrateurs-cps.asipsante.fr/pages/prosanteconnect/presentation-generale">ProSantéConnect</a>.
En effet, ProSantéConnect fournit une bonne alternative à nos outils SSO basés sur la carte CPS et le standard PKCS11. J&rsquo;ai donc voulu décrire un peu les mécanismes d&rsquo;intégration dans spring-boot qui est notre framework de prédilection.</p>
<p>Or, nous n&rsquo;avons que réaliser ce qui est déjà bien décrit par <a href="https://patriceblanchardie.fr/pro-sante-connect/">Patrice Blanchardie dans son blog</a>. Nous vous invitons donc à lire son article.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-fb097e60bfd5ea8478e641381706b920">Installation d&#39;un lecteur PC/SC sous linux ubuntu</h1>
	<div class="lead">Comment installer un lecteur PC/SC sous linux Ubuntu</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2021-06-01" class="text-muted">Tuesday, June 01, 2021</time>
        
	</div>
	<p>L&rsquo;installation sous Linux, Ubuntu dans mon cas, d&rsquo;un lecteur PC/SC. </p>
<p>En résumé, il faut installer les packages suivants :</p>
<p>J&rsquo;ai récupéré les drivers spécifiques pour mon lecteur, un Liteo Olaqin dans mon cas : <a href="https://www.olaqin.fr/actualite-et-support-de-votre-liteo/">https://www.olaqin.fr/actualite-et-support-de-votre-liteo/</a></p>
<ul>
<li>Télécharger le driver</li>
<li>Décompresser le driver</li>
<li>lire le Readme</li>
</ul>
<h2 id="step-1-installation-les-librairies-pcsc-on-trouve-toutes-les-informations-sur-httpsdocubuntu-frorgsmartcards">Step 1 : Installation les librairies PC/SC. On trouve toutes les informations sur <a href="https://doc.ubuntu-fr.org/smartcards">https://doc.ubuntu-fr.org/smartcards</a></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo apt-get install pcscd
</span></span><span style="display:flex;"><span>sudo apt-get install libpcsclite1
</span></span><span style="display:flex;"><span>sudo apt-get install pcsc-tools
</span></span></code></pre></div><p>Check de l&rsquo;installation : <code>pcsc_scan</code></p>
<h2 id="step-2-installation-des-libusb">Step 2 : Installation des libusb</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sudo apt-get install libusb-1.0-0-dev
</span></span></code></pre></div><h2 id="step-3-">Step 3 :</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#204a87">cd</span> scmccid_5.0.35_linux
</span></span><span style="display:flex;"><span>sudo ./install.sh
</span></span></code></pre></div><p>## Step 4 : optionnel</p>
<p>## Step 5 : reload pcsclite deamon</p>
<pre tabindex="0"><code>ldd /usr/sbin/pcscd
</code></pre>
</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-16ce0b61ec2098c0edd36dbc9f3228b1">Installer &gt; lancer la DevBox-Santé depuis un navigateur</h1>
	<div class="lead">Lancer une DevBox-santé depuis le navigateur</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2021-05-27" class="text-muted">Thursday, May 27, 2021</time>
        
	</div>
	<p>Certains contextes nécessitent de lancer la DevBox-santé depuis le context client. Pour le faire nous nous servons des URI Scheme et de la possibilité d&rsquo;enregistrer une application sur ce scheme.
Exemple, dans Windows : <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa767914(v=vs.85)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa767914(v=vs.85)?redirectedfrom=MSDN</a></p>
<p>Notre installer permet d&rsquo;enregistrer un URI scheme à la DevBox-Santé, ainsi lorsque nous saisissons <code>devboxsante://</code> dans notre navigateur :</p>
<p><img src="2021-05-27_saisie_url_scheme.png" alt="DevBox-sante URL Scheme"></p>
<p>Le navigateur nous propose de lancer l&rsquo;exécutable sur le poste de l&rsquo;utilisateur :</p>
<p><img src="2021-05-27_lancement_depuis_navigateur.png" alt="DevBox-sante lancer depuis le navigateur"></p>
<p>Il est possible de le faire simplement en javascript depuis une page html de votre client :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#204a87;font-weight:bold">html</span><span style="color:#000;font-weight:bold">&gt;&lt;</span><span style="color:#204a87;font-weight:bold">body</span><span style="color:#000;font-weight:bold">&gt;&lt;</span><span style="color:#204a87;font-weight:bold">script</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#204a87">window</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;devboxsante://&#34;</span><span style="color:#000;font-weight:bold">);&lt;/</span><span style="color:#204a87;font-weight:bold">script</span><span style="color:#000;font-weight:bold">&gt;&lt;/</span><span style="color:#204a87;font-weight:bold">body</span><span style="color:#000;font-weight:bold">&gt;&lt;/</span><span style="color:#204a87;font-weight:bold">html</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span></code></pre></div><p>Comme si ça ne suffisait pas, il est également possible de passer dans l&rsquo;url un ensemble d&rsquo;arguments configurables par ce mécanisme.
Par exemple, le numéro de port :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>devboxsante://config?server.port<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">10000</span>
</span></span></code></pre></div><p>Par ce type de mécanisme, il est possible de lancer la devbox-sante avec un contexte qui est le votre et moyennant un callback vers vos serveurs lier la DevBox-Santé avec une session utilisateur.</p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-87ab15ff12fb2fae33bbe79303f82722">DMP &gt; matrice habilitation</h1>
	<div class="lead">Quels sont les documents accessibles pour un acteur de santé</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2021-05-20" class="text-muted">Thursday, May 20, 2021</time>
        
	</div>
	<p>Les documents dans le DMP contient un certains nombres de métadata comme : </p>
<ul>
<li>classCode</li>
<li>confidentialityCode</li>
<li>typeCode</li>
<li>formatCode</li>
<li>practiceSettingCode</li>
</ul>
<p>La visibilité d&rsquo;un document pour un acteur de santé dépend du typeCode, le typeCode est une spécialisation du classCode</p>
<p>Pour connaître les types de documents qui peuvent être accédés par un professionnel de santé, il faut suivre la matrice<br>
des habilitations : <a href="https://www.dmp.fr/matrice-habilitation">https://www.dmp.fr/matrice-habilitation</a></p>
<p><img src="matrice_habilitation_extrait.png" alt="matrice_habilitation_extrait.png"></p>
<h3 id="dans-le-guide-dintégration">Dans le guide d&rsquo;intégration</h3>
<blockquote>
<p>Les conditions d’accès en lecture aux documents contenus dans le DMP d’un patient (sur lequel ils ont l’autorisation d’accès) dépendent des professions et spécialités des PS recueillies à partir de la carte CPS du PS. Ces règles sont définies dans la matrice d’habilitation [DMP-MHAB].</p>
</blockquote>
<h3 id="dans-la-devboxsanté-dmp">Dans la DevBoxSanté-DMP</h3>
<ul>
<li>
<p>Connaître la liste des typeCode :</p>
<ul>
<li>API Java :</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#5c35cc;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">private</span> <span style="color:#000">DMPCClient</span> <span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Récupération des différents classCode
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCodesFor</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">DMPCCode</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ASIPJeuxValeurs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">CLASS_CODE</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">// Récupération des différents typeCode
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span><span style="color:#000">client</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">getCodesFor</span><span style="color:#ce5c00;font-weight:bold">(</span><span style="color:#000">DMPCCode</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">ASIPJeuxValeurs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#c4a000">TYPE_CODE</span><span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>API REST</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl --location --request GET <span style="color:#4e9a06">&#39;https://dmpc-api-rest-3-1.herokuapp.com/proxy/nomenclatures/?jeuxValeurs=TYPE_CODE&#39;</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span>--header <span style="color:#4e9a06">&#39;Content-Type: application/json&#39;</span> <span style="color:#4e9a06">\
</span></span></span></code></pre></div><h3 id="lors-de-lhomologation">Lors de l&rsquo;homologation</h3>
<p>Exemple de test à valider lors de l&rsquo;homologation :</p>
<blockquote>
<p>L&rsquo;utilisateur s&rsquo;authentifie avec une carte CPS autorisée à accéder au DMP du patient.
Un document invisible  (confidentialityCode  « INVISIBLE_PATIENT») est déjà présent sur le DMP.
Le PS est habilité à accéder à ce type de document (cf. matrice d&rsquo;habilitations).
Le PS demande à mettre à jour le document afin de le rendre visible du patient (confidentialityCode  : vide).
En retour le SI DMP confirme la mise à jour du document.<br>
=&gt; Mode opératoire :   Rendre visible le document 70 (typeCode 11502-2 (CR d&rsquo;examens biologiques))</p>
</blockquote>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-c20c69a2aad7fcab8fb238d2bf53a8f0">Diagnostiquer des problèmes d&#39;accès aux lecteurs</h1>
	<div class="lead">Comment diagnostiquer vos problèmes de lecteur</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2021-05-14" class="text-muted">Friday, May 14, 2021</time>
        
	</div>
	<p>Lors de l&rsquo;utilisation de composants de lecteur CPS et de Carte Vitale de la DevBox-Santé, vous pouvez rencontrer des problèmes d&rsquo;accés aux lecteurs.</p>
<p>Ces problèmes sont dues principalement à deux sources de problème.</p>
<ul>
<li>La première, l&rsquo;utilisation du galss qui nécessite d&rsquo;être
installé qu&rsquo;une seule fois sur le poste et est très sensible aux différents ports physiques choisis pour connecter vos lecteurs.</li>
<li>La deuxième est que certains composants sont installés dans des versions anciennes.</li>
</ul>
<h2 id="utiliser-un-lecteur-homologué-dans-sa-bonne-version">Utiliser un lecteur homologué dans sa bonne version</h2>
<p>Le GIE Sesam-Vitale tient une liste à jour des lecteurs homologués et dans quelle version applicative. Il vous faut repérer le lecteur et son application.
Pour vous aider, <a href="https://industriels.sesam-vitale.fr/documents/10192/3574897/Liste+des+derni%C3%A8res+versions+d%27applications+de+lecteurs+homologu%C3%A9s+SESAM-Vitale">voici le lien vers la liste des lecteurs en date de février 2021</a></p>
<p>Sesam-Vitale met également à disposition des documents permettant d&rsquo;obtenir les informations de version des lecteurs :</p>
<ul>
<li><a href="Proc%C3%A9dures_manuelles_KAPELSE.pdf">Kapelse</a></li>
<li><a href="Proc%C3%A9dures_manuelles_OLAQIN.pdf">Olaqin</a></li>
</ul>
<h2 id="proscrire-le-galss">Proscrire le GALSS</h2>
<p>Les vieux lecteurs PSS utilisant le GALSS sont dépréciés et devront ne plus être installés à la fin de l&rsquo;année 2021. Alors,
préférez dans la mesure du possible des lecteurs configurés en PC/SC.</p>
<p><img src="AbandonGalss_communication_sesam_vitale_pcsc.png" alt="20210514_diagnostiquer_problèmes_lecteurs\AbandonGalss_communication_sesam_vitale_pcsc.png"></p>
<h2 id="utilisation-de-loutil-de-diagnostic-diagam">Utilisation de l&rsquo;outil de diagnostic DiagAM</h2>
<p>Pour aider au diagnostic du problème, Sesam-Vitale met à disposition un outil de diagnostic diagAM.</p>
<p>Pour l&rsquo;utiliser, il faut suivre la procédure suivante :</p>
<ul>
<li>Télécharger le programme d&rsquo;installation du  composant ATSAM : <a href="">https://www.dmp.fr/ps/composants-poste-etape-deux</a></li>
<li>Lancer l&rsquo;installation et sélectionner dans un premier temps que l&rsquo;outil de diagnostic :</li>
</ul>
<p><img src="DiagAM_install_1.png" alt="DiagAM_install_1.png"></p>
<ul>
<li>Lancer l&rsquo;outil DiagAM à la fin de l&rsquo;installation.</li>
</ul>
<p><img src="DiagAM_install_2.png" alt="DiagAM_install_2.png"></p>
<ul>
<li>Sauvegarder le rapport pour analyse</li>
</ul>
<p><img src="DiagAM_running.png" alt="DiagAM_running.png"></p>
<p>Ici on voit que la cryptolib nécessite une réinstallation. Ce qui est rendu possible en appuyant sur la clé a molette.
Néanmoins, ce n&rsquo;est pas un soucis car nos installers embarquent la cryptolib nécessaire.</p>
<p>Par contre les informations concernant l&rsquo;installation du GALSS nous est nécessaire en cas d&rsquo;utilisation d&rsquo;un lecteur en
mode PSS :</p>
<p>Exemple, dans le cas suivant le galss.ini n&rsquo;existe pas dans le répertoire <code>%WINDIR%</code> et aucun lecteur n&rsquo;est trouvé:</p>
<p><img src="DiagAM_galss_problem.png" alt="DiagAM_galss_problem.png"></p>
<p>Un clic sur la clé à molette du galss, permettra de réinitialiser un galss :</p>
<p><img src="DiagAM_galss_lecteur_trouve.png" alt="DiagAM_galss_lecteur_trouve.png"></p>
<p>Pour plus d&rsquo;information sur l&rsquo;outil de diagnostic, l&rsquo;aide en ligne est disponible ici : <a href="">https://www.sesam-vitale.fr/o/porte-document-web/atsam/ael/DiagAM2.html</a></p>

</div>





    
	
  
    
    
	
    


  

<div class="td-content" style="page-break-before: always">
    <h1 id="pg-adb945f145a47b5cc09702edfd029719">Génération de la documentation de la DevBox-Santé</h1>
	<div class="lead">Utilisation de <a href="https://gohugo.io">Hugo</a> pour la génération du site.</div>
	<div class="td-byline mb-4">
		Par <b>Laurent Forêt</b> |
        
		<time datetime="2021-05-12" class="text-muted">Wednesday, May 12, 2021</time>
        
	</div>
	<p>Ça y est nous avons pris le temps de regrouper la documentation disponible de la DevBox-Santé en un seul endroit.
Cela donne ce site de documentation, qui pourra s&rsquo;étoffer également d&rsquo;articles parlant de sujet d&rsquo;intégration de la DevBox-Santé d&rsquo;une part,
et d&rsquo;intéropérabilité dans la santé d&rsquo;autre part.</p>
<p>Les quelques sujets du moment (liste non exhaustive) :</p>
<ul>
<li>Les Modèles d&rsquo;Objets de Santé : <a href="https://esante.gouv.fr/interoperabilite/mos-nos">https://esante.gouv.fr/interoperabilite/mos-nos</a></li>
<li>Les priorités du Ségur : <a href="https://solidarites-sante.gouv.fr/systeme-de-sante-et-medico-social/segur-de-la-sante-les-conclusions/">https://solidarites-sante.gouv.fr/systeme-de-sante-et-medico-social/segur-de-la-sante-les-conclusions/</a>
et comment les outils de la DevBox-Santé peuvent fournir des briques essentielles.</li>
</ul>
<p>Si vous souhaitez générer un site de documentation similaire au notre, je ne peux que vous conseiller d&rsquo;utiliser un <a href="https://themes.gohugo.io/">thème Hugo</a>.
Le thème qui m&rsquo;a paru le plus convaincant lors de la génération de ce site documentaire est <a href="https://themes.gohugo.io/docsy/">Docsy</a>.</p>

</div>





    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="www.devbox-sante.fr" aria-label="www.devbox-sante.fr">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.devbox-sante.fr" aria-label="www.devbox-sante.fr">
      <i class="icon iconFoot icon-devbox"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="BitBucket" aria-label="BitBucket">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/google/docsy" aria-label="BitBucket">
      <i class="fab fa-bitbucket"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Contactez-nous" aria-label="Contactez-nous">
    <a class="text-white" target="_blank" rel="noopener" href="mailto://devbox-sante@devcoop.fr" aria-label="Contactez-nous">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 DevBox Santé Tous droits réservés</small>
        <small class="ml-1"><a href="https://www.devbox-sante.fr/mentions" target="_blank" rel="noopener">Politique de confidentialité</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
  <script src='/js/deflate.js'></script>
<script src="/js/main.min.d6689e66e94757874459ff899c857f7b4685d2837186c2efd9b3620fd738899f.js" integrity="sha256-1mieZulHV4dEWf&#43;JnIV/e0aF0oNxhsLv2bNiD9c4iZ8=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
